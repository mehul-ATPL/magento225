<?php
/**
 * Strategery Infinitescroll - Magento 2 Module
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0),
 * available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 *
 * @license http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 * @copyright Copyright (c) 2016 Strategery Inc. (http://www.strategery.io/)
 * @author Damian A. Pastorini (damian.pastorini@strategery.io)
 */
?>
<?php /** @var $block \Strategery\Infinitescroll\Block\Init */ ?>
<?php if ($block->isEnabled()) : ?>
    <?php
    $productListMode = $block->getProductListMode();
    $mode = ($productListMode == 'grid') ? $block->getSelector('items_grid') : $block->getSelector('items_list');
    ?>
    <script>
        window.iasConfig = {
            mode: '<?php echo $block->escapeHtml($mode); ?>',
            debug: <?php echo (int) $block->getScrollConfig('general/debug'); ?>,
            container: '<?php echo $block->escapeHtml($block->getSelector('content')); ?>',
            next: '<?php echo $block->escapeHtml($block->getSelector('next')); ?>',
            pagination: '<?php echo $block->escapeHtml($block->getSelector('pagination')); ?>',
            buffer: <?php echo (int) $block->getDesign('buffer_px'); ?>,
            prev: '<?php echo $block->escapeHtml($block->getSelector('previous')); ?>',
            text: '<?php echo $block->escapeJsQuote(__($block->getDesign('done_text'))); ?>',
            html: '<div class="ias-noneleft" style="text-align: center;">{text}</div>',
            <?php if ($block->getLoaderImage() !== false) : ?>
            spinnerSrc: '<?php echo $block->escapeUrl($block->getLoaderImage()); ?>',
            <?php else : ?>
            spinnerSrc: 'data:image/png;base64,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',
            <?php endif; ?>
            spinnerHtml: '<?php echo '<div class="ias-spinner" style="text-align: center;"><img style="display:inline" src="{src}"/> '.
                $block->escapeJsQuote(__($block->getScrollConfig('design/loading_text'))).
                '</div>'; ?>',
            trigger: {
                text: '<?php echo $block->escapeJsQuote(__($block->getDesign('load_more_text'))); ?>',
                html: '<div class="ias-trigger ias-trigger-next" style="text-align: center; cursor: pointer;"><a>{text}</a></div>',
                textPrev: '<?php echo $block->escapeJsQuote(__($block->getDesign('load_more_text_prev'))); ?>',
                htmlPrev: '<div class="ias-trigger ias-trigger-prev" style="text-align: center; cursor: pointer;"><a>{text}</a></div>',
                offset: <?php echo (int) $block->getDesign('load_more_threshold'); ?>
            },
            toolbarSelector: '<?php echo $block->escapeHtml($block->getSelector('toolbar')); ?>',
            toolbarAction: '<?php echo $block->getDesign('hide_toolbar') ? 'hide' : 'show'; ?>',
            memoryActive: <?php echo $block->isMemoryActive() ? 'true' : 'false'; ?>
        };
        require(['jquery', 'infinitescroll'], function($){
            $(function($) {
                // InfiniteScroll:
                SgyIAS.init();
            });
        });
    </script>
<?php endif ?>
